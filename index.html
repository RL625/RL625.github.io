<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‡ºåŒ—å¸‚æˆ¿å±‹ç¨…ç‡è©¦ç®—å™¨</title>
    <link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@500&family=SF+Pro+Text:wght@400;500&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'SF Pro Text', -apple-system, BlinkMacSystemFont, sans-serif;
            -webkit-font-smoothing: antialiased;
        }

        body {
            background-color: #f5f5f7;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            background: #ffffff;
            width: 100%;
            max-width: 540px;
            padding: 40px;
            border-radius: 18px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        }

        h1 {
            font-family: 'SF Pro Display', sans-serif;
            font-size: 32px;
            font-weight: 500;
            color: #1d1d1f;
            text-align: center;
            margin-bottom: 8px;
        }

        p.subtitle {
            font-size: 16px;
            color: #6e6e73;
            text-align: center;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
            display: none;
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .form-group.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        label {
            display: block;
            font-size: 14px;
            color: #1d1d1f;
            margin-bottom: 8px;
            font-weight: 500;
        }

        select, input {
            width: 100%;
            padding: 12px;
            border: 1px solid #d2d2d7;
            border-radius: 10px;
            font-size: 16px;
            background: #f5f5f7;
            color: #1d1d1f;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #007aff;
            box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
        }

        input[disabled] {
            background: #e8e8ed;
            color: #86868b;
        }

        button {
            width: 100%;
            padding: 14px;
            background: #007aff;
            color: #ffffff;
            border: none;
            border-radius: 10px;
            font-size: 17px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease;
        }

        button:hover {
            background: #0066cc;
        }

        button:active {
            transform: scale(0.98);
        }

        #result {
            margin-top: 25px;
            padding: 20px;
            border-radius: 10px;
            background: #f5f5f7;
            display: none;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        #result h3 {
            font-family: 'SF Pro Display', sans-serif;
            font-size: 18px;
            font-weight: 500;
            color: #1d1d1f;
            margin-bottom: 12px;
        }

        #result p {
            font-size: 15px;
            color: #1d1d1f;
            margin: 6px 0;
        }

        #result strong {
            color: #ff3b30;
            font-weight: 500;
        }

        .warning {
            color: #ff3b30;
            font-size: 13px;
            margin-top: 10px;
        }

        .warning ul {
            padding-left: 15px;
            margin: 5px 0;
        }

        .warning li {
            margin: 3px 0;
        }

        .hint {
            color: #ff3b30;
            font-size: 13px;
            margin-top: 5px;
        }

        .links-section {
            margin-top: 25px;
            padding: 20px;
            background: #f5f5f7;
            border-radius: 10px;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
        }

        .links-section h3 {
            font-family: 'SF Pro Display', sans-serif;
            font-size: 16px;
            font-weight: 500;
            color: #1d1d1f;
            margin-bottom: 15px;
            text-align: center;
        }

        .links-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .links-section .link-button {
            display: inline-flex;
            align-items: center;
            padding: 10px;
            background: none;
            color: #007aff;
            text-decoration: none;
            font-size: 15px;
            transition: color 0.3s ease;
            justify-content: center;
        }

        .links-section .link-button:hover {
            color: #0066cc;
        }

        .links-section .download-button {
            color: #007aff;
        }

        .links-section .download-button:hover {
            color: #0066cc;
        }

        .links-section .link-button .icon {
            margin-right: 8px;
            font-size: 16px;
            transition: transform 0.3s ease;
        }

        .links-section .link-button:hover .icon {
            transform: translateX(3px);
        }

        @media (max-width: 600px) {
            .container {
                padding: 25px;
            }

            h1 {
                font-size: 28px;
            }

            p.subtitle {
                font-size: 14px;
            }

            button {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>è‡ºåŒ—å¸‚æˆ¿å±‹ç¨…ç‡è©¦ç®—å™¨</h1>
        <p class="subtitle">é©ç”¨æ–¼è‡ª113å¹´7æœˆ1æ—¥èµ·</p>

        <div class="form-group active" id="typeGroup">
            <label>æˆ¿å±‹ä½¿ç”¨æƒ…å½¢</label>
            <select id="type">
                <option value="residential">ä½å®¶ç”¨</option>
                <option value="non_residential">éä½å®¶ç”¨</option>
            </select>
        </div>

        <div class="form-group" id="residentialGroup">
            <label>ä½å®¶ç”¨é€”</label>
            <select id="residentialUsage">
                <option value="single_self">å…¨åœ‹å–®ä¸€è‡ªä½ï¼ˆç¾å€¼ä½æ–¼2,842,000å…ƒï¼‰</option>
                <option value="self">è‡ªä½ç”¨</option>
                <option value="non_self">éè‡ªä½</option>
            </select>
        </div>

        <div class="form-group" id="nonSelfGroup">
            <label id="nonSelfLabel">éè‡ªä½é¡å‹</label>
            <select id="nonSelfUsage">
                <option value="rent_standard">å‡ºç§Ÿç”³å ±ç§Ÿè³ƒæ‰€å¾—é”ç§Ÿé‡‘æ¨™æº–ï¼ˆè‡ºåŒ—å¸‚112å¹´åº¦ç§Ÿé‡‘æ¨™æº–ç‚ºæˆ¿å±‹ç¾å€¼27%ï¼‰</option>
                <option value="inherited_shared">ç¹¼æ‰¿å–å¾—åˆ†åˆ¥å…±æœ‰æˆ¿å±‹ï¼ˆå–®ç¨æŒæœ‰æˆ¿å±‹é™¤å¤–ï¼‰</option>
                <option value="developer">èµ·é€ äººæŒæœ‰å¾…éŠ·å”®æˆ¿å±‹</option>
                <option value="other_residential">å…¶ä»–ä½å®¶ç”¨æˆ¿å±‹ï¼ˆå«ç©ºç½®æˆ¿å±‹ã€åœ°ä¸‹ç§Ÿè³ƒæˆ¿å±‹ç­‰ï¼‰</option>
                <option value="social_rent_public">å…¬ç›Šå‡ºç§ŸäººåŠåŒ…ç§Ÿä»£ç®¡æˆ¿å±‹ç¨…å„ªæƒ  - å…¬ç›Šå‡ºç§Ÿäºº</option>
                <option value="social_rent_package">å…¬ç›Šå‡ºç§ŸäººåŠåŒ…ç§Ÿä»£ç®¡æˆ¿å±‹ç¨…å„ªæƒ  - ç¤¾æœƒä½å®…åŒ…ç§Ÿä»£ç®¡æˆ¿å±‹ï¼ˆä¿®æ³•ä¸­ï¼‰</option>
                <option value="personal_rent">å…¬ç›Šå‡ºç§ŸäººåŠåŒ…ç§Ÿä»£ç®¡æˆ¿å±‹ç¨…å„ªæƒ  - å€‹äººç§Ÿè³ƒä½å®…åŒ…ç§Ÿä»£ç®¡æˆ¿å±‹</option>
                <option value="public_housing">å…¬æœ‰æˆ¿å±‹</option>
                <option value="worker_dorm">å‹å·¥å®¿èˆåŠå…¶é™„è¨­å“¡å·¥é¤å»³ï¼ˆéœ€å‹å·¥ä¸»ç®¡æ©Ÿé—œè­‰æ˜ï¼‰</option>
                <option value="shared_part">å€åˆ†æ‰€æœ‰å»ºç¯‰ç‰©å…±æœ‰éƒ¨åˆ†ï¼ˆé ˜æœ‰å–®ç¨å»ºç‰©æ‰€æœ‰æ¬Šç‹€ï¼‰</option>
                <option value="parking_space">å°ˆä¾›åœæ”¾è»Šè¼›ä½¿ç”¨ä¹‹åœè»Šç©ºé–“</option>
                <option value="co_owned">å…¬åŒå…±æœ‰æˆ¿å±‹</option>
                <option value="care_facility">é•·æœŸç…§é¡§æœå‹™æ©Ÿæ§‹åŠè€äººç¦åˆ©æ©Ÿæ§‹ä½å®¿æˆ¿å±‹</option>
                <option value="cultural_asset">æ–‡åŒ–è³‡ç”¢ä¿å­˜æ³•ç™»éŒ„ä¹‹èšè½å»ºç¯‰ç¾¤ã€å²è¹ŸåŠæ–‡åŒ–æ™¯è§€</option>
                <option value="public_construction">æ°‘é–“åƒèˆ‡å…¬å…±å»ºè¨­æ¡ˆä¹‹å…¬å…±å»ºè¨­æˆ–é™„å±¬äº‹æ¥­</option>
                <option value="damaged_house">ç„šç‡¬ã€åå¡Œã€æ‹†é™¤è‡³ä¸å ªå±…ä½ç¨‹åº¦ä¹‹æˆ¿å±‹</option>
                <option value="disaster_relief">ç½å€å—ç½å±…æ°‘å±…ä½ä½¿ç”¨ä¹‹æˆ¿å±‹ï¼ˆè²¡æ”¿éƒ¨æ ¸å®šï¼‰</option>
                <option value="industrial_park">ç”¢æ¥­åœ’å€ä½å®…ï¼ˆä¾è¦å®šå‡ºç§Ÿä½¿ç”¨ï¼‰</option>
                <option value="leasing_management">æ³•äººä½å®…å§”è¨—ç§Ÿè³ƒä½å®…ä»£ç®¡æ¥­æˆ–åŒ…ç§Ÿæ¥­è½‰ç§Ÿ</option>
            </select>
            <div id="nonSelfHint" class="hint"></div>
        </div>

        <div class="form-group" id="nonSelfSubGroup">
            <label>ç§Ÿé‡‘æ¨™æº–é¸æ“‡</label>
            <select id="nonSelfSubUsage">
                <option value="standard">é”ç§Ÿé‡‘æ¨™æº–</option>
                <option value="below_standard">æœªé”ç§Ÿé‡‘æ¨™æº–</option>
            </select>
            <div class="hint">è‡ºåŒ—å¸‚112å¹´åº¦ç§Ÿé‡‘æ¨™æº–ç‚ºæˆ¿å±‹ç¾å€¼27%ï¼Œä¾‹ï¼šæˆ¿å±‹ç¾å€¼300,000ï¼Œç§Ÿé‡‘æ¨™æº–ï¼ˆæ¯æœˆï¼‰ç‚º6,750å…ƒï¼Œé«˜æ–¼6,750å‰‡é©ç”¨1.5%ï¼Œä½æ–¼å‰‡é©ç”¨2%ã€‚</div>
        </div>

        <div class="form-group" id="nonResidentialGroup">
            <label>éä½å®¶ç”¨é€”</label>
            <select id="nonResidentialUsage">
                <option value="business">ä¾›ç‡Ÿæ¥­ç”¨</option>
                <option value="medical_office">ä¾›ç§äººé†«é™¢ã€è¨ºæ‰€æˆ–è‡ªç”±è·æ¥­äº‹å‹™æ‰€ä½¿ç”¨</option>
                <option value="non_profit">ä¾›äººæ°‘åœ˜é«”ç­‰éç‡Ÿæ¥­ä½¿ç”¨</option>
            </select>
        </div>

        <div class="form-group" id="householdsGroup">
            <label>å…¨åœ‹æŒæœ‰æˆ¶æ•¸</label>
            <input type="number" id="households" min="1" value="1">
            <div id="householdsHint" class="hint"></div>
        </div>

        <div class="form-group" id="yearsGroup">
            <label>æŒæœ‰å¹´æ•¸ï¼ˆå¹´ï¼‰</label>
            <input type="number" id="years" min="0" value="0">
        </div>

        <button onclick="calculateTax()">è¨ˆç®—ç¨…ç‡</button>

        <div id="result"></div>

        <div class="links-section">
            <h3>ç”³è¾¦é€£çµ</h3>
            <div class="links-container">
                <a href="https://service.gov.taipei/Case/ApplyWay/201907120329" target="_blank" class="link-button">
                    <span class="icon">ğŸ”—</span> å¸‚æ°‘æœå‹™å¤§å¹³è‡º
                </a>
                <a href="https://www.etax.nat.gov.tw/etwmain/etw109w/cases/services/OLF015015/0" target="_blank" class="link-button">
                    <span class="icon">ğŸ”—</span> è²¡æ”¿éƒ¨ç¨…å‹™å…¥å£ç¶²
                </a>
                <a href="https://net.tax.nat.gov.tw/PLRX/Lrx200d01/" target="_blank" class="link-button">
                    <span class="icon">ğŸ”—</span> åœ°æ–¹ç¨…ç¶²è·¯ç”³å ±ä½œæ¥­
                </a>
                <a href="https://www-ws.gov.taipei/001/Upload/336/relfile/16016/108633/78e628f5-a6e6-4dc0-97ec-4861f69d6554.odt" target="_blank" class="link-button download-button">
                    <span class="icon">ğŸ“¥</span> ç”³è«‹æ›¸ä¸‹è¼‰
                </a>
            </div>
        </div>
    </div>

    <script>
        const typeSelect = document.getElementById('type');
        const residentialGroup = document.getElementById('residentialGroup');
        const nonSelfGroup = document.getElementById('nonSelfGroup');
        const nonSelfSubGroup = document.getElementById('nonSelfSubGroup');
        const nonResidentialGroup = document.getElementById('nonResidentialGroup');
        const residentialUsage = document.getElementById('residentialUsage');
        const nonSelfUsage = document.getElementById('nonSelfUsage');
        const nonSelfSubUsage = document.getElementById('nonSelfSubUsage');
        const nonSelfLabel = document.getElementById('nonSelfLabel');
        const householdsGroup = document.getElementById('householdsGroup');
        const yearsGroup = document.getElementById('yearsGroup');
        const householdsInput = document.getElementById('households');
        const householdsHint = document.getElementById('householdsHint');
        const nonSelfHint = document.getElementById('nonSelfHint');

        function updateForm() {
            const type = typeSelect.value;
            const resUsage = residentialUsage.value;
            const nonSelfType = nonSelfUsage.value;
            const households = parseInt(householdsInput.value) || 1;

            residentialGroup.classList.remove('active');
            nonSelfGroup.classList.remove('active');
            nonSelfSubGroup.classList.remove('active');
            nonResidentialGroup.classList.remove('active');
            householdsGroup.classList.remove('active');
            yearsGroup.classList.remove('active');
            householdsHint.textContent = '';
            nonSelfHint.textContent = '';

            const nonCountedTypes = [
                'social_rent_public', 'social_rent_package', 'personal_rent', 'public_housing',
                'worker_dorm', 'shared_part', 'parking_space', 'co_owned', 'care_facility',
                'cultural_asset', 'public_construction', 'damaged_house', 'disaster_relief',
                'industrial_park', 'leasing_management'
            ];

            if (type === 'residential') {
                residentialGroup.classList.add('active');
                if (resUsage === 'self') {
                    householdsGroup.classList.add('active');
                    householdsInput.disabled = false;
                    householdsInput.max = '';
                    householdsHint.textContent = 'è‡ªä½ç”¨å…¨åœ‹é™3æˆ¶å…§ï¼Œè¶…é3æˆ¶çš„éƒ¨åˆ†å°‡æ­¸é¡ç‚ºéè‡ªä½æˆ¿å±‹';
                    if (households > 3) {
                        nonSelfGroup.classList.add('active');
                        nonSelfLabel.textContent = 'éè‡ªä½é¡å‹ï¼ˆè¶…é3æˆ¶éƒ¨åˆ†ï¼‰';
                        if (nonSelfType === 'developer') {
                            yearsGroup.classList.add('active');
                            householdsGroup.classList.remove('active');
                        } else if (nonCountedTypes.includes(nonSelfType)) {
                            householdsGroup.classList.remove('active');
                            yearsGroup.classList.remove('active');
                        } else {
                            yearsGroup.classList.remove('active');
                            householdsGroup.classList.add('active');
                        }
                        if (nonCountedTypes.includes(nonSelfType)) {
                            nonSelfHint.textContent = 'æŒæœ‰æˆ¶æ•¸ä¸è¨ˆå…¥å…¨åœ‹æ­¸æˆ¶';
                        }
                        if (nonSelfType === 'personal_rent' || nonSelfType === 'public_housing' || nonSelfType === 'worker_dorm' || nonSelfType === 'shared_part' || nonSelfType === 'parking_space' || nonSelfType === 'co_owned' || nonSelfType === 'care_facility' || nonSelfType === 'cultural_asset' || nonSelfType === 'public_construction' || nonSelfType === 'damaged_house' || nonSelfType === 'disaster_relief' || nonSelfType === 'industrial_park' || nonSelfType === 'leasing_management') {
                            nonSelfSubGroup.classList.add('active');
                        } else {
                            nonSelfSubGroup.classList.remove('active');
                        }
                    }
                } else if (resUsage === 'single_self') {
                    householdsGroup.classList.add('active');
                    householdsInput.value = 1;
                    householdsInput.disabled = true;
                    householdsHint.textContent = 'å…¨åœ‹åƒ…1æˆ¶';
                } else if (resUsage === 'non_self') {
                    nonSelfGroup.classList.add('active');
                    nonSelfLabel.textContent = 'éè‡ªä½é¡å‹';
                    if (nonSelfType === 'developer') {
                        yearsGroup.classList.add('active');
                        householdsGroup.classList.remove('active');
                    } else if (nonCountedTypes.includes(nonSelfType)) {
                        householdsGroup.classList.remove('active');
                        yearsGroup.classList.remove('active');
                    } else {
                        yearsGroup.classList.remove('active');
                        householdsGroup.classList.add('active');
                        householdsInput.disabled = false;
                        householdsInput.max = '';
                    }
                    if (nonCountedTypes.includes(nonSelfType)) {
                        nonSelfHint.textContent = 'æŒæœ‰æˆ¶æ•¸ä¸è¨ˆå…¥å…¨åœ‹æ­¸æˆ¶';
                    }
                    if (nonSelfType === 'personal_rent' || nonSelfType === 'public_housing' || nonSelfType === 'worker_dorm' || nonSelfType === 'shared_part' || nonSelfType === 'parking_space' || nonSelfType === 'co_owned' || nonSelfType === 'care_facility' || nonSelfType === 'cultural_asset' || nonSelfType === 'public_construction' || nonSelfType === 'damaged_house' || nonSelfType === 'disaster_relief' || nonSelfType === 'industrial_park' || nonSelfType === 'leasing_management') {
                        nonSelfSubGroup.classList.add('active');
                    } else {
                        nonSelfSubGroup.classList.remove('active');
                    }
                }
            } else if (type === 'non_residential') {
                nonResidentialGroup.classList.add('active');
            }
        }

        typeSelect.addEventListener('change', updateForm);
        residentialUsage.addEventListener('change', updateForm);
        nonSelfUsage.addEventListener('change', updateForm);
        nonSelfSubUsage.addEventListener('change', updateForm);
        householdsInput.addEventListener('input', updateForm);
        updateForm();

        function calculateTax() {
            const type = typeSelect.value;
            const resUsage = residentialUsage.value;
            const nonSelfType = nonSelfUsage.value;
            const nonSelfSubType = nonSelfSubUsage.value;
            const nonResUsage = document.getElementById('nonResidentialUsage').value;
            let households = parseInt(document.getElementById('households').value);
            const years = parseInt(document.getElementById('years').value);
            let taxRateSelf = 0;
            let effectiveTaxRateSelf = 0;
            let taxRateNonSelf = 0;
            let effectiveTaxRateNonSelf = 0;
            let warnings = [];
            let selfHouseholds = 0;
            let nonSelfHouseholds = 0;
            let totalHouseholdsForNonSelf = households;

            const nonCountedTypes = [
                'social_rent_public', 'social_rent_package', 'personal_rent', 'public_housing',
                'worker_dorm', 'shared_part', 'parking_space', 'co_owned', 'care_facility',
                'cultural_asset', 'public_construction', 'damaged_house', 'disaster_relief',
                'industrial_park', 'leasing_management'
            ];

            if (type === 'residential') {
                if (resUsage === 'single_self') {
                    taxRateSelf = 1.0;
                    effectiveTaxRateSelf = 0.7;
                    selfHouseholds = 1;
                    warnings.push('é©ç”¨å‰æï¼šæˆ¿å±‹ç¾å€¼é ˆä½æ–¼2,842,000å…ƒï¼Œè‹¥è¶…éæ­¤é‡‘é¡ï¼Œç¨…ç‡å¯èƒ½ä¸åŒã€‚');
                    warnings.push('é™¤åŸæœ‰è‡ªä½è¦ä»¶å¤–ï¼Œæ‡‰æ–¼æ¯å¹´3æœˆ22æ—¥å‰æœ‰æœ¬äººã€é…å¶æˆ–ç›´ç³»è¦ªå±¬è¾¦ç«£æˆ¶ç±ç™»è¨˜ã€‚');
                    warnings.push('è‡ª113å¹´7æœˆ1æ—¥èµ·ï¼ŒæŒæœ‰æœ¬å¸‚ä¹‹å…¨åœ‹å–®ä¸€è‡ªä½æˆ¿å±‹ä¸”æˆ¿å±‹ç¾å€¼åœ¨ä¸€å®šé‡‘é¡ä»¥ä¸‹è€…ï¼Œå°‡åˆ†4å¹´é€å¹´ç·©æ­¥æ¢å¾©èª²ç¨…ç¨…åŸºï¼Œ114å¹´æœŸè‡³116å¹´æœŸæˆ¿å±‹ç¨…åŸºåˆ†åˆ¥æŠ˜æ¸›30%ã€20%ã€10%(ç›¸ç•¶ç¨…ç‡0.7%ã€0.8%ã€0.9%)ï¼Œè‡ª117å¹´æœŸèµ·ç¨…åŸºä¸å†æŠ˜æ¸›(æ¢å¾©æ³•å®šç¨…ç‡1.0%)ã€‚');
                } else if (resUsage === 'self') {
                    taxRateSelf = 1.2;
                    if (households <= 3) {
                        selfHouseholds = households;
                        warnings.push('é™¤åŸæœ‰è‡ªä½è¦ä»¶å¤–ï¼Œæ‡‰æ–¼æ¯å¹´3æœˆ22æ—¥å‰æœ‰æœ¬äººã€é…å¶æˆ–ç›´ç³»è¦ªå±¬è¾¦ç«£æˆ¶ç±ç™»è¨˜ã€‚');
                        warnings.push('è‡ªä½ç”¨å…¨åœ‹é™3æˆ¶å…§ã€‚');
                        warnings.push('è‡ª113å¹´7æœˆ1æ—¥èµ·ï¼ŒæŒæœ‰æœ¬å¸‚ä¹‹å…¨åœ‹å–®ä¸€è‡ªä½æˆ¿å±‹ä¸”æˆ¿å±‹ç¾å€¼åœ¨ä¸€å®šé‡‘é¡ä»¥ä¸‹è€…ï¼Œå°‡åˆ†4å¹´é€å¹´ç·©æ­¥æ¢å¾©èª²ç¨…ç¨…åŸºï¼Œ114å¹´æœŸè‡³116å¹´æœŸæˆ¿å±‹ç¨…åŸºåˆ†åˆ¥æŠ˜æ¸›30%ã€20%ã€10%(ç›¸ç•¶ç¨…ç‡0.7%ã€0.8%ã€0.9%)ï¼Œè‡ª117å¹´æœŸèµ·ç¨…åŸºä¸å†æŠ˜æ¸›(æ¢å¾©æ³•å®šç¨…ç‡1.0%)ã€‚');
                    } else {
                        selfHouseholds = 3;
                        nonSelfHouseholds = households - 3;
                        if (nonCountedTypes.includes(nonSelfType)) {
                            totalHouseholdsForNonSelf = 0;
                            nonSelfHouseholds = 0;
                        } else {
                            totalHouseholdsForNonSelf = households;
                        }

                        if (nonSelfType === 'rent_standard' || nonSelfType === 'inherited_shared') {
                            if (totalHouseholdsForNonSelf <= 4) taxRateNonSelf = 1.5;
                            else if (totalHouseholdsForNonSelf <= 6) taxRateNonSelf = 2.0;
                            else taxRateNonSelf = 2.4;
                            effectiveTaxRateNonSelf = taxRateNonSelf;
                        } else if (nonSelfType === 'developer') {
                            if (years <= 1) taxRateNonSelf = 2.0;
                            else if (years <= 2) taxRateNonSelf = 2.4;
                            else if (years <= 4) taxRateNonSelf = 3.6;
                            else if (years <= 5) taxRateNonSelf = 4.2;
                            else taxRateNonSelf = 4.8;
                            effectiveTaxRateNonSelf = taxRateNonSelf;
                            warnings.push('èµ·é€ äººæŒæœ‰å¾…éŠ·å”®æˆ¿å±‹æŒ‰æŒæœ‰å¹´æ•¸è¨‚å®šå·®åˆ¥ç¨…ç‡');
                        } else if (nonSelfType === 'other_residential') {
                            if (totalHouseholdsForNonSelf <= 2) taxRateNonSelf = 3.2;
                            else if (totalHouseholdsForNonSelf <= 4) taxRateNonSelf = 3.8;
                            else if (totalHouseholdsForNonSelf <= 6) taxRateNonSelf = 4.2;
                            else taxRateNonSelf = 4.8;
                            effectiveTaxRateNonSelf = taxRateNonSelf;
                        } else if (nonSelfType === 'social_rent_public') {
                            taxRateNonSelf = 1.2;
                            effectiveTaxRateNonSelf = 0.75;
                            warnings.push('è‡ª113å¹´7æœˆ1æ—¥èµ·ï¼ŒæŒæœ‰æœ¬å¸‚ä¾›å…¬ç›Šå‡ºç§Ÿäººå‡ºç§Ÿä½¿ç”¨åŠç¤¾æœƒä½å®…åŒ…ç§Ÿä»£ç®¡æˆ¿å±‹ï¼Œå°‡åˆ†4å¹´é€å¹´ç·©æ­¥æ¢å¾©èª²ç¨…ç¨…åŸºï¼Œ114å¹´æœŸè‡³116å¹´æœŸæˆ¿å±‹ç¨…åŸºåˆ†åˆ¥æŠ˜æ¸›37.5%ã€25%ã€12.5%(ç›¸ç•¶ç¨…ç‡0.75%ã€0.9%ã€1.05%)ï¼Œè‡ª117å¹´æœŸèµ·ç¨…åŸºä¸å†æŠ˜æ¸›(æ¢å¾©æ³•å®šç¨…ç‡1.2%)ã€‚');
                        } else if (nonSelfType === 'social_rent_package') {
                            taxRateNonSelf = 1.2;
                            effectiveTaxRateNonSelf = 0.75;
                            warnings.push('è‡ª113å¹´7æœˆ1æ—¥èµ·ï¼ŒæŒæœ‰æœ¬å¸‚ä¾›å…¬ç›Šå‡ºç§Ÿäººå‡ºç§Ÿä½¿ç”¨åŠç¤¾æœƒä½å®…åŒ…ç§Ÿä»£ç®¡æˆ¿å±‹ï¼Œå°‡åˆ†4å¹´é€å¹´ç·©æ­¥æ¢å¾©èª²ç¨…ç¨…åŸºï¼Œ114å¹´æœŸè‡³116å¹´æœŸæˆ¿å±‹ç¨…åŸºåˆ†åˆ¥æŠ˜æ¸›37.5%ã€25%ã€12.5%(ç›¸ç•¶ç¨…ç‡0.75%ã€0.9%ã€1.05%)ï¼Œè‡ª117å¹´æœŸèµ·ç¨…åŸºä¸å†æŠ˜æ¸›(æ¢å¾©æ³•å®šç¨…ç‡1.2%)ã€‚');
                            warnings.push('<span class="warning">è‡ºåŒ—å¸‚ç¤¾æœƒä½å®…èˆˆè¾¦åŠå…¬ç›Šå‡ºç§Ÿäººå‡ºç§Ÿæˆ¿å±‹æ¸›å…åœ°åƒ¹ç¨…åŠæˆ¿å±‹ç¨…è‡ªæ²»æ¢ä¾‹åˆ»ä¿®æ³•ä¸­ï¼Œä¾è‡ºåŒ—å¸‚æ”¿åºœ113å¹´9æœˆ5æ—¥é å‘Šä¿®æ­£è©²è‡ªæ²»æ¢ä¾‹ä¿®æ­£è‰æ¡ˆï¼Œæ“¬å°‡æœ¬å¸‚ç¤¾æœƒä½å®…åŒ…ç§Ÿä»£ç®¡æˆ¿å±‹ç¨…æ¸›å¾µæ¯”ä¾‹ï¼Œç”±æ¸›å¾µç¨…é¡20%ï¼Œèª¿æ•´ç‚ºé©ç”¨æ¸›å¾µä¹‹ç‰¹å®šç¨…ç‡å³1.2%ã€‚</span>');
                        } else if (nonSelfType === 'personal_rent') {
                            taxRateNonSelf = nonSelfSubType === 'standard' ? 1.5 : 2.0;
                            effectiveTaxRateNonSelf = taxRateNonSelf * 0.6;
                        } else if (nonSelfType === 'public_housing' || nonSelfType === 'worker_dorm' || nonSelfType === 'shared_part' || nonSelfType === 'parking_space' || nonSelfType === 'co_owned' || nonSelfType === 'care_facility' || nonSelfType === 'cultural_asset' || nonSelfType === 'public_construction' || nonSelfType === 'damaged_house' || nonSelfType === 'disaster_relief' || nonSelfType === 'industrial_park' || nonSelfType === 'leasing_management') {
                            taxRateNonSelf = nonSelfSubType === 'standard' ? 1.5 : 2.0;
                            effectiveTaxRateNonSelf = taxRateNonSelf;
                            warnings.push('ä¾è²¡æ”¿éƒ¨113å¹´4æœˆ22æ—¥å°è²¡ç¨…å­—ç¬¬11300522190è™Ÿä»¤è¨‚å®šã€Œæˆ¿å±‹ç¨…æ¢ä¾‹ç¬¬äº”æ¢èˆ‡ç¬¬åäº”æ¢ç¬¬ä¸€é …ç¬¬ä¹æ¬¾è¦å®šä½å®¶ç”¨æˆ¿å±‹æˆ¶æ•¸èªå®šåŠç”³å ±æ“‡å®šè¾¦æ³•ã€ç¬¬4æ¢åŠè©²éƒ¨åŒå¹´10æœˆ30æ—¥å°è²¡ç¨…å­—ç¬¬11304654260è™Ÿä»¤å…¬å¸ƒä¹‹ä¸è¨ˆå…¥å…¨åœ‹æˆ¶æ•¸ä¹‹ä½å®¶ç”¨æˆ¿å±‹é¡å‹ã€‚');
                        }
                        if (nonSelfHouseholds > 0 && warnings.length === 0 && nonSelfType !== 'developer') {
                            warnings.push('å…¨åœ‹æŒæœ‰æˆ¶æ•¸è¶…é3æˆ¶ï¼Œè¶…ééƒ¨åˆ†å·²æ­¸é¡ç‚ºéè‡ªä½æˆ¿å±‹ã€‚');
                        }
                    }
                } else if (resUsage === 'non_self') {
                    if (!nonCountedTypes.includes(nonSelfType)) {
                        nonSelfHouseholds = households;
                        totalHouseholdsForNonSelf = households;
                    } else {
                        nonSelfHouseholds = 0;
                        totalHouseholdsForNonSelf = 0;
                    }

                    if (nonSelfType === 'rent_standard' || nonSelfType === 'inherited_shared') {
                        if (totalHouseholdsForNonSelf <= 4) taxRateNonSelf = 1.5;
                        else if (totalHouseholdsForNonSelf <= 6) taxRateNonSelf = 2.0;
                        else taxRateNonSelf = 2.4;
                        effectiveTaxRateNonSelf = taxRateNonSelf;
                    } else if (nonSelfType === 'developer') {
                        if (years <= 1) taxRateNonSelf = 2.0;
                        else if (years <= 2) taxRateNonSelf = 2.4;
                        else if (years <= 4) taxRateNonSelf = 3.6;
                        else if (years <= 5) taxRateNonSelf = 4.2;
                        else taxRateNonSelf = 4.8;
                        effectiveTaxRateNonSelf = taxRateNonSelf;
                        warnings.push('èµ·é€ äººæŒæœ‰å¾…éŠ·å”®æˆ¿å±‹æŒ‰æŒæœ‰å¹´æ•¸è¨‚å®šå·®åˆ¥ç¨…ç‡');
                    } else if (nonSelfType === 'other_residential') {
                        if (totalHouseholdsForNonSelf <= 2) taxRateNonSelf = 3.2;
                        else if (totalHouseholdsForNonSelf <= 4) taxRateNonSelf = 3.8;
                        else if (totalHouseholdsForNonSelf <= 6) taxRateNonSelf = 4.2;
                        else taxRateNonSelf = 4.8;
                        effectiveTaxRateNonSelf = taxRateNonSelf;
                    } else if (nonSelfType === 'social_rent_public') {
                        taxRateNonSelf = 1.2;
                        effectiveTaxRateNonSelf = 0.75;
                        warnings.push('è‡ª113å¹´7æœˆ1æ—¥èµ·ï¼ŒæŒæœ‰æœ¬å¸‚ä¾›å…¬ç›Šå‡ºç§Ÿäººå‡ºç§Ÿä½¿ç”¨åŠç¤¾æœƒä½å®…åŒ…ç§Ÿä»£ç®¡æˆ¿å±‹ï¼Œå°‡åˆ†4å¹´é€å¹´ç·©æ­¥æ¢å¾©èª²ç¨…ç¨…åŸºï¼Œ114å¹´æœŸè‡³116å¹´æœŸæˆ¿å±‹ç¨…åŸºåˆ†åˆ¥æŠ˜æ¸›37.5%ã€25%ã€12.5%(ç›¸ç•¶ç¨…ç‡0.75%ã€0.9%ã€1.05%)ï¼Œè‡ª117å¹´æœŸèµ·ç¨…åŸºä¸å†æŠ˜æ¸›(æ¢å¾©æ³•å®šç¨…ç‡1.2%)ã€‚');
                    } else if (nonSelfType === 'social_rent_package') {
                        taxRateNonSelf = 1.2;
                        effectiveTaxRateNonSelf = 0.75;
                        warnings.push('è‡ª113å¹´7æœˆ1æ—¥èµ·ï¼ŒæŒæœ‰æœ¬å¸‚ä¾›å…¬ç›Šå‡ºç§Ÿäººå‡ºç§Ÿä½¿ç”¨åŠç¤¾æœƒä½å®…åŒ…ç§Ÿä»£ç®¡æˆ¿å±‹ï¼Œå°‡åˆ†4å¹´é€å¹´ç·©æ­¥æ¢å¾©èª²ç¨…ç¨…åŸºï¼Œ114å¹´æœŸè‡³116å¹´æœŸæˆ¿å±‹ç¨…åŸºåˆ†åˆ¥æŠ˜æ¸›37.5%ã€25%ã€12.5%(ç›¸ç•¶ç¨…ç‡0.75%ã€0.9%ã€1.05%)ï¼Œè‡ª117å¹´æœŸèµ·ç¨…åŸºä¸å†æŠ˜æ¸›(æ¢å¾©æ³•å®šç¨…ç‡1.2%)ã€‚');
                        warnings.push('<span class="warning">è‡ºåŒ—å¸‚ç¤¾æœƒä½å®…èˆˆè¾¦åŠå…¬ç›Šå‡ºç§Ÿäººå‡ºç§Ÿæˆ¿å±‹æ¸›å…åœ°åƒ¹ç¨…åŠæˆ¿å±‹ç¨…è‡ªæ²»æ¢ä¾‹åˆ»ä¿®æ³•ä¸­ï¼Œä¾è‡ºåŒ—å¸‚æ”¿åºœ113å¹´9æœˆ5æ—¥é å‘Šä¿®æ­£è©²è‡ªæ²»æ¢ä¾‹ä¿®æ­£è‰æ¡ˆï¼Œæ“¬å°‡æœ¬å¸‚ç¤¾æœƒä½å®…åŒ…ç§Ÿä»£ç®¡æˆ¿å±‹ç¨…æ¸›å¾µæ¯”ä¾‹ï¼Œç”±æ¸›å¾µç¨…é¡20%ï¼Œèª¿æ•´ç‚ºé©ç”¨æ¸›å¾µä¹‹ç‰¹å®šç¨…ç‡å³1.2%ã€‚</span>');
                    } else if (nonSelfType === 'personal_rent') {
                        taxRateNonSelf = nonSelfSubType === 'standard' ? 1.5 : 2.0;
                        effectiveTaxRateNonSelf = taxRateNonSelf * 0.6;
                    } else if (nonSelfType === 'public_housing' || nonSelfType === 'worker_dorm' || nonSelfType === 'shared_part' || nonSelfType === 'parking_space' || nonSelfType === 'co_owned' || nonSelfType === 'care_facility' || nonSelfType === 'cultural_asset' || nonSelfType === 'public_construction' || nonSelfType === 'damaged_house' || nonSelfType === 'disaster_relief' || nonSelfType === 'industrial_park' || nonSelfType === 'leasing_management') {
                        taxRateNonSelf = nonSelfSubType === 'standard' ? 1.5 : 2.0;
                        effectiveTaxRateNonSelf = taxRateNonSelf;
                        warnings.push('ä¾è²¡æ”¿éƒ¨113å¹´4æœˆ22æ—¥å°è²¡ç¨…å­—ç¬¬11300522190è™Ÿä»¤è¨‚å®šã€Œæˆ¿å±‹ç¨…æ¢ä¾‹ç¬¬äº”æ¢èˆ‡ç¬¬åäº”æ¢ç¬¬ä¸€é …ç¬¬ä¹æ¬¾è¦å®šä½å®¶ç”¨æˆ¿å±‹æˆ¶æ•¸èªå®šåŠç”³å ±æ“‡å®šè¾¦æ³•ã€ç¬¬4æ¢åŠè©²éƒ¨åŒå¹´10æœˆ30æ—¥å°è²¡ç¨…å­—ç¬¬11304654260è™Ÿä»¤å…¬å¸ƒä¹‹ä¸è¨ˆå…¥å…¨åœ‹æˆ¶æ•¸ä¹‹ä½å®¶ç”¨æˆ¿å±‹é¡å‹ã€‚');
                    }
                }
            } else if (type === 'non_residential') {
                if (nonResUsage === 'business') taxRateNonSelf = 3.0;
                else if (nonResUsage === 'medical_office') taxRateNonSelf = 3.0;
                else if (nonResUsage === 'non_profit') taxRateNonSelf = 2.0;
                effectiveTaxRateNonSelf = taxRateNonSelf;
                nonSelfHouseholds = 0;
            }

            const resultDiv = document.getElementById('result');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `
                <h3>è¨ˆç®—çµæœ</h3>
                <p>æˆ¿å±‹ä½¿ç”¨æƒ…å½¢ï¼š${type === 'residential' ? 'ä½å®¶ç”¨' : 'éä½å®¶ç”¨'}</p>
                ${type === 'residential' && resUsage === 'self' ? `
                    <p>ä½å®¶ç”¨é€”ï¼šè‡ªä½ç”¨</p>
                    <p>è‡ªä½ç”¨æˆ¶æ•¸ï¼š${selfHouseholds} æˆ¶ï¼Œé©ç”¨ç¨…ç‡ï¼š<strong>${taxRateSelf}%</strong></p>
                    ${nonSelfHouseholds > 0 ? `
                        ${nonSelfType !== 'developer' ? `<p>éè‡ªä½ç”¨æˆ¶æ•¸ï¼š${nonSelfHouseholds} æˆ¶</p>` : ''}
                        <p>éè‡ªä½é¡å‹ï¼š${document.getElementById('nonSelfUsage').options[document.getElementById('nonSelfUsage').selectedIndex].text}</p>
                        ${(nonSelfType === 'personal_rent' || nonSelfType === 'public_housing' || nonSelfType === 'worker_dorm' || nonSelfType === 'shared_part' || nonSelfType === 'parking_space' || nonSelfType === 'co_owned' || nonSelfType === 'care_facility' || nonSelfType === 'cultural_asset' || nonSelfType === 'public_construction' || nonSelfType === 'damaged_house' || nonSelfType === 'disaster_relief' || nonSelfType === 'industrial_park' || nonSelfType === 'leasing_management') ? `<p>ç§Ÿé‡‘æ¨™æº–é¸æ“‡ï¼š${document.getElementById('nonSelfSubUsage').options[document.getElementById('nonSelfSubUsage').selectedIndex].text}</p>` : ''}
                        <p>éè‡ªä½é©ç”¨ç¨…ç‡ï¼š<strong>${effectiveTaxRateNonSelf}%</strong> ${effectiveTaxRateNonSelf !== taxRateNonSelf ? `(æ³•å®šç¨…ç‡ ${taxRateNonSelf}%)` : ''}</p>
                    ` : ''}
                ` : type === 'residential' && resUsage === 'single_self' ? `
                    <p>ä½å®¶ç”¨é€”ï¼šå…¨åœ‹å–®ä¸€è‡ªä½ï¼ˆç¾å€¼ä½æ–¼2,842,000å…ƒï¼‰</p>
                    <p>è‡ªä½ç”¨æˆ¶æ•¸ï¼š${selfHouseholds} æˆ¶ï¼Œé©ç”¨ç¨…ç‡ï¼š<strong>${effectiveTaxRateSelf}%</strong> ${effectiveTaxRateSelf !== taxRateSelf ? `(æ³•å®šç¨…ç‡ ${taxRateSelf}%)` : ''}</p>
                ` : type === 'residential' && resUsage === 'non_self' ? `
                    <p>ä½å®¶ç”¨é€”ï¼šéè‡ªä½</p>
                    <p>éè‡ªä½é¡å‹ï¼š${document.getElementById('nonSelfUsage').options[document.getElementById('nonSelfUsage').selectedIndex].text}</p>
                    ${(nonSelfType === 'personal_rent' || nonSelfType === 'public_housing' || nonSelfType === 'worker_dorm' || nonSelfType === 'shared_part' || nonSelfType === 'parking_space' || nonSelfType === 'co_owned' || nonSelfType === 'care_facility' || nonSelfType === 'cultural_asset' || nonSelfType === 'public_construction' || nonSelfType === 'damaged_house' || nonSelfType === 'disaster_relief' || nonSelfType === 'industrial_park' || nonSelfType === 'leasing_management') ? `<p>ç§Ÿé‡‘æ¨™æº–é¸æ“‡ï¼š${document.getElementById('nonSelfSubUsage').options[document.getElementById('nonSelfSubUsage').selectedIndex].text}</p>` : ''}
                    ${nonSelfType !== 'developer' && !nonCountedTypes.includes(nonSelfType) ? `<p>éè‡ªä½æˆ¶æ•¸ï¼š${nonSelfHouseholds} æˆ¶</p>` : ''}
                    <p>éè‡ªä½é©ç”¨ç¨…ç‡ï¼š<strong>${effectiveTaxRateNonSelf}%</strong> ${effectiveTaxRateNonSelf !== taxRateNonSelf ? `(æ³•å®šç¨…ç‡ ${taxRateNonSelf}%)` : ''}</p>
                ` : `
                    <p>éä½å®¶ç”¨é€”ï¼š${document.getElementById('nonResidentialUsage').options[document.getElementById('nonResidentialUsage').selectedIndex].text}</p>
                    <p>é©ç”¨ç¨…ç‡ï¼š<strong>${effectiveTaxRateNonSelf}%</strong></p>
                `}
                ${(nonSelfType === 'developer') ? `<p>æŒæœ‰å¹´æ•¸ï¼š${years} å¹´</p>` : ''}
                ${warnings.length > 0 ? `
                    <p class="warning">
                        ${warnings.length > 1 ? `
                            <ul>
                                ${warnings.map(w => `<li>${w}</li>`).join('')}
                            </ul>
                        ` : warnings[0]}
                    </p>
                ` : ''}
            `;
        }
    </script>
</body>
</html>